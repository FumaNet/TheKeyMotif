# TheKeyMotif
Repository for the Cognitive Science and Artificial Intelligence Thesis at Tilburg University

This thesis extends the PhageHostLearn tool by Boeckaerts et al. (2024, original code can be found at https://github.com/dimiboeckaerts/PhageHostLearn ) to work with individual protein embeddings; it also shows that a One-Hot Encoding approach is viable when the host serotype is identified. 

Having identified individual proteins as sufficient for determining adsorption, conserved elements among pahges infecting the same serotype are searched for: full results, including meme results and individual conserved sequences for all serotypes with at least 3 infecting phages, are available in the Motifs_KO folder. Reported results focused on the serotypes with at least 6 infecting phages: K11, K13, K14, K29, K30, K36, K63 and K64, for which AlphaFold-generated 3D structures and .cif files with the identified motif highlighted are also uploaded in the respective subfolders.

The identified motifs are also shown to be more informative than a random RBP in training a model, when the same amount of data is kept.

## FOLDERS:

### Data: 
see file RequiredFiles.txt for in-depth requirements. PHL Zenodo repository can be found at https://zenodo.org/records/11061100

### Graphs: 
Jupyter Notebook reporting the code used to generate the graphs presented in the paper

### Results:
stores results generated by models 0-5. Results from model 6 were evaluated but not saved in the same format during the initial run, so it was not uploadeed, but can be generated by running file 6b.

### Motifs_KO:
contains one folder for each serotype for which at least 3 successfully infecting phages were found in the dataset. 
For each serotype, the file "protein_sequences_k#_positive.fasta" contains the concatenated RBP sequences of infecting phages, and was uploaded to MEME. MEME results were stored as .meme and .txt
For serotypes K11, K13, K14, K29, K30, K36, K63 and K64, AlphaFold-generated 3D structures and .cif files with the identified motif highlighted can also be found in the subfolders named after the RBP where the motif was identified.



## FILES:

_Motifs_Pipeline.ipynb_
a Jupyter Notebook that analyses the extracted motifs, conserved proteins, and protein scores.

_finding_groups.py_
used to generate the host genomic-derived groupings at different thresholds that can be found in the folder "grouping"

_single_protein_loci.py_
used to generate the "esm2_embeddings_loci_per_protein.csv" file required to train models. It keeps individual embeddings separate, instead of averaging them.

_0_original_replica.py_
loads individual embeddings, then averages them to replicate the results of the original PHL pipeline. A sanity check.

_1_max_max.py_
loads individual embeddings and trains a model on all possible protein-protein pairings. During evaluation it takes the max of all pairings for a virus-host pair as its score.

_2_max_max_original_sero_
loads individual embeddings, then averages them as the original pipeline did, but replaces the host embeddigns for a one-hot encoded representation of the serotype, significantly reducing the amount of features needed, but limiting the approach to well-identified bacterial capsules.

_3_max_max_sero.py_
combines the two previous approaches: keeps RBP embeddings separate, and uses serotypes for bacterial embeddings. During evaluation it takes the max among all viral RBP-serotype pairs as its score.

_4_motif_focus_increased.py_
Keeps the individual RBP-serotype approach, but re-labels the dataset to better distinguish individual protein contributions. Only the RBPs where a motif was found are labelled as positives (1), alongside the positive virus-host samples where the virus only expressed one RBP. A random protein is sampled from each negative pair of the original dataset, undersampling it.

_5_motif_focus.py_
Keeps the individual RBP-serotype approach, but re-labels the dataset to better distinguish individual protein contributions. Only the RBPs where a motif was found are labelled as positives (1). A random protein is sampled from each negative pair of the original dataset, undersampling it.

_6a_motif_vs_random_100.py_
Trains a model on only the 100% threshold. This model modifies the previous one by instead taking a random protein from the virus, specificall a non motif-bearing protein if one is present. Used to compare the results of 5 with a model trained on a similar amount of data, but that tries to avoid the motif-bearing proteins when possible, to see whether those are more informative than others.

_6b_motif_vs_random_multithreshold.py_
An extension of 6a to include multiple thresholds. Results from this models were not saved during the initial run, so they were not uploaded in the Results folder.

